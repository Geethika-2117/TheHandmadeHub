<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>The Handmade Hub</title>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
        <link rel="stylesheet" href="style.css">
    </head>

    <body>
        <section id="header">
            <div class="logo">
            <i class="fas fa-hand-paper icon"></i>
            <pre>The 
Handmade
Hub</pre>
        </div>
        <div>
            <ul id="navbar">
                <li><a href="index.html">Home</a></li>
                <li><a href="shop.html">Shop</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a  class= "active" href="cart.html"><i class="fas fa-bag-shopping"></i></a></li>
            </ul>
        </div>
        </section>

        <section id="page-header" class="cart-header">
           
            <h2 >#ReviewYourOrder</h2>
            
            <p >Explore Your Cart, Full of Green Choices</p>
            
        </section>

        <section id="cart" class="section-p1">
            <table width="100%">
                <thead>
                    <tr>
                        <td>REMOVE</td>
                        <td>IMAGE</td>
                        <td>PRODUCT</td>
                        <td>PRICE</td>
                        <td>QUANTITY</td>
                        <td>SUBTOTAL</td>
                    </tr>
                </thead>
                <tbody id="cartItems">
                    <tr>
                        <td><a href="#"><i class="fas fa-trash"></i></a></td>
                        <td><img src="./img/claypottery.jpg" slt="claypottery"></td>
                        <td>Clay Pottery</td>
                        <td>₹499</td>
                        <td><input type="number" value="3"></td>
                        <td>₹1497</td>
                    </tr>
                    <tr>
                        <td><a href="#"><i class="fas fa-trash"></i></a></td>
                        <td><img src="./img/paperjournals.jpg" alt="paperjournals"></td>
                        <td>Paper Journals</td>
                        <td>₹299</td>
                        <td><input type="number" value="2"></td>
                        <td>₹598</td>
                    </tr>
                    <tr>
                        <td><a href="#"><i class="fas fa-trash"></i></a></td>
                        <td><img src="./img/woolscarves.jpg" alt="wool scarves"></td>
                        <td>Wool Scarves</td>
                        <td>₹799</td>
                        <td><input type="number" value="1"></td>
                        <td>₹799</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="cart-add" class="section-p1">
            <div id="coupon">
                <h3>Apply Coupon</h3>
                <div>
                    <input type="text" id="couponCode" placeholder="Enter Your Coupon">
                    <button class="normal" onclick="applyCoupon()">Apply</button>
                </div>
                <div id="couponMessage">
                    <h2 style="font-size: 25px; color:#088178;">Available Coupons:</h2><br>
                    <ul style="list-style-type: none;">
                        <li>SAVE10 - ₹10 off</li><br>
                        <li>SAVE50 - ₹50 off</li><br>
                        <li> OFF10 - 10% off</li>
                    </ul>
                </div>
            </div>

            <div id="subtotal">
                <h3>Cart Totals</h3>
                <table>
                    <tr>
                        <td>Cart Subtotal</td>
                        <td id="cartSubtotal">₹0</td>
                    </tr>
                    <tr>
                        <td>Shipping</td>
                        <td>Free(₹0)</td>
                    </tr>
                    <tr>
                        <td>Discount</td>
                        <td id="cartDiscount">₹0</td>
                    </tr>
                    <tr>
                        <td>Total</td>
                        <td id="cartTotal">₹0</td>
                    </tr>
                </table>
                <button class="normal" onclick="proceedToCheckout()">Procced to Checkout</button>
            </div>
        </section>

            <footer class="section-p1">
            <div class="col">
                <h4>Contact</h4>
                <p><strong>Address:</strong>Amrita Vishwa Vidyapeetham</p>
                <p><strong>Phone:</strong>9876543210</p>
                <p><strong>Hours:</strong>10am to 18pm</p>
                <div class="follow">
                    <h4>Follow us</h4>
                    <div class="icon">
                        <i class="fab fa-facebook"></i>
                        <i class="fab fa-twitter"></i>
                        <i class="fab fa-instagram"></i>
                        <i class="fab fa-youtube"></i>
                        <i class="fab fa-pinterest"></i>
                    </div>
                </div>
            </div>
            <div class="col">
                <h4>About</h4>
                <a href="about.html">About Us</a>
                <a href="contact.html">Contact Us</a>
            </div>
            <div class="col">
                <h4>My account</h4>
                <a href="#">View cart</a>
                <a href="tandc.html">Terms and conditions</a>
            </div>
            <div class="col install">
                <h4>Install App</h4>
                <p>From apple store or Google play</p>
                <div class="row">
                    <img src="./img/gplay.png" width="150" height="40" alt="img1">
                    <img src="./img/appstore.png" width="150" height="40" alt="img2">
                </div>
                <p>Secure Payment Gateway</p>
                <img src="./img/payment.jpg" width="350" height="60" alt="payment">
            </div>

            <div class="copyright" style="padding-left: 80px;">
                <p>Copyright.All rights reserved.</p>
            </div>
        </footer>

        <script>
function loadCart() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const cartItemsContainer = document.getElementById("cartItems");
    const subtotalDisplay = document.getElementById("cartSubtotal");
    const totalDisplay = document.getElementById("cartTotal");

    cartItemsContainer.innerHTML = "";
    let cartSubtotal = 0;

    if (cart.length === 0) {
        cartItemsContainer.innerHTML = `<tr><td colspan="6" style="text-align:center">Your cart is empty.</td></tr>`;
        subtotalDisplay.textContent = "₹0";
        totalDisplay.textContent = "₹0";
        return;
    }

    cart.forEach(product => {
        const subtotal = product.price * product.quantity;
        cartSubtotal += subtotal;

        const row = document.createElement("tr");
        row.innerHTML = `
            <td><a href="#" onclick="removeItem('${product.name}')"><i class="fas fa-trash"></i></a></td>
            <td><img src="${product.image}" alt="${product.name}" width="60"></td>
            <td>${product.name}</td>
            <td>₹${product.price}</td>
            <td><input type="number" value="${product.quantity}" min="1" onchange="updateQuantity('${product.name}', this.value)"></td>
            <td>₹${subtotal}</td>
        `;
        cartItemsContainer.appendChild(row);
    });

    subtotalDisplay.textContent = `₹${cartSubtotal}`;
    totalDisplay.textContent = `₹${cartSubtotal}`; // Assuming free shipping
}

function updateQuantity(productName, newQty) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart = cart.map(item => {
        if (item.name === productName) {
            item.quantity = parseInt(newQty);
        }
        return item;
    });
    localStorage.setItem("cart", JSON.stringify(cart));
    loadCart();
}

function removeItem(productName) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart = cart.filter(item => item.name !== productName);
    localStorage.setItem("cart", JSON.stringify(cart));
    loadCart();
}

let currentDiscount = 0;
let currentSubtotal = 0;

function applyCoupon() {
    const code = document.getElementById("couponCode").value.trim().toUpperCase();
    let discount = 0;

    if (code === "SAVE10") {
        discount = 10;
    } else if (code === "SAVE50") {
        discount = 50;
    } else if (code === "OFF10") {
        discount = currentSubtotal * 0.10;
    } else {
        alert("Invalid coupon code");
        discount = 0;
    }

    currentDiscount = Math.min(discount, currentSubtotal); // prevent negative totals
    updateCartTotalsDisplay();
}

function updateCartTotalsDisplay() {
    const subtotalEl = document.getElementById("cartSubtotal");
    const discountEl = document.getElementById("cartDiscount");
    const totalEl = document.getElementById("cartTotal");

    subtotalEl.textContent = `₹${currentSubtotal}`;
    discountEl.textContent = `₹${currentDiscount}`;
    totalEl.textContent = `₹${currentSubtotal - currentDiscount}`;
}

// Update loadCart() to set currentSubtotal:
function loadCart() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const cartItemsContainer = document.getElementById("cartItems");

    cartItemsContainer.innerHTML = "";
    currentSubtotal = 0;

    if (cart.length === 0) {
        cartItemsContainer.innerHTML = `<tr><td colspan="6" style="text-align:center">Your cart is empty.</td></tr>`;
        currentDiscount = 0;
        updateCartTotalsDisplay();
        return;
    }

    cart.forEach(product => {
        const subtotal = product.price * product.quantity;
        currentSubtotal += subtotal;

        const row = document.createElement("tr");
        row.innerHTML = `
            <td><a href="#" onclick="removeItem('${product.name}')"><i class="fas fa-trash"></i></a></td>
            <td><img src="${product.image}" alt="${product.name}" width="60"></td>
            <td>${product.name}</td>
            <td>₹${product.price}</td>
            <td><input type="number" value="${product.quantity}" min="1" onchange="updateQuantity('${product.name}', this.value)"></td>
            <td>₹${subtotal}</td>
        `;
        cartItemsContainer.appendChild(row);
    });

    updateCartTotalsDisplay();
}

window.onload = loadCart;

function proceedToCheckout() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const summary = {
        cart,
        subtotal: currentSubtotal,
        discount: currentDiscount,
        total: currentSubtotal - currentDiscount
    };

    // Store this data for checkout page to use
    localStorage.setItem("checkoutSummary", JSON.stringify(summary));

    // Redirect
    window.location.href = "checkout.html";
}
</script>

    </body>
</html>